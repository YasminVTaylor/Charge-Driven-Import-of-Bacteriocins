# Charge-Driven-Import-of-Bacteriocins: Electrostatic Potential

prerequiste: 
Pandas, matplotlib, numpy, bio, mdtraj

This script calculates the physiological isoelectric point (pI) and the APBS electrostatics of the pores for each of the TBDTs which had been returned by the PSI-BLAST search.
##pI calculation:
Each TBDT was aligned along the Z-axis using PyMOL. The difference in solvent accessible surface area (SASA) between the structures with and without the labile subdomain was calculated at a residue level using MDAnalysis. The unplugged protein was then sliced along the Z-axis into 12Å-height regions (parameter run_avg in the script), with a shift of 2.5Å (parameter shift). Within each region, the pI was calculated using a function implemented in the library Biopython which considers the subset of residues showing a percentage change in SASA higher than 20% (parameter threshold) upon the removal of the plug. The implemented script returns the average Z and the pI of each sliced region. 

##Electrostatics calculation:
Electrostatics calculations were performed using APBS (Adaptive Poisson-Boltzmann Solver). PDB2PQR converts the PDB files of the unplugged TBDTs into PQR files (the Amber force field is used). APBS returns the electrostatic potential calculated at the nodes of a 3D grid, where each cell is a cube with a spacing of ~0.5 Å. The nearest neighbour interpolation implemented in the Scipy library was used to interpolate the electrostatic potential along the pore. The coordinates of the pore were defined using ChexViS, an online tool that determines transmembrane pores (Masood et al., 2015) availabile at http://vgl.serc.iisc.ernet.in/chexvis/. The implemented script replaces the β-factors in the PDB of the pore generated by ChexVis with the value of the interpolated electrostatic potential.  
 
